<main class="expozitii-permanente">
  <div class="decorative-borders">
    <div class="decorative-border-left"></div>
    <div class="decorative-border-right"></div>
  </div>
  
  <app-meniu></app-meniu>
  <app-cadran>
    <div class="container">
      <div class="header-nav">
        <button class="back-button" routerLink="/">{{ 'exhibitionsBackHome' | translate }}</button>
      </div>
      <h2>{{ 'exhibitionsPermanentTitle' | translate }}</h2>
      
      <p class="intro-text">
        {{ 'exhibitionsIntroText' | translate }}
      </p>

      <div class="category-selector">
        <button [class.active]="selectedSection === 'istorie'" (click)="switchSection('istorie')">{{ 'exhibitionsHistoryBtn' | translate }}</button>
        <button [class.active]="selectedSection === 'etnografie'" (click)="switchSection('etnografie')">{{ 'exhibitionsEthnographyBtn' | translate }}</button>
        <button [class.active]="selectedSection === 'aerLiber'" (click)="switchSection('aerLiber')">{{ 'exhibitionsOutdoorBtn' | translate }}</button>
      </div>

      <div class="section-description" *ngIf="selectedSection === 'istorie'">
        <h2>{{ 'exhibitionsHistoryTitle' | translate }}</h2>
        <p><em>{{ 'exhibitionsHistoryInaugurated' | translate }}</em></p>
        <p>
          {{ 'exhibitionsHistoryDescription' | translate }}
        </p>

        <div *ngIf="isAdmin" class="admin-section">
          <div class="admin-header">
            <h3>{{ 'landscapesAdminSection' | translate }}</h3>
          </div>
          
          <div class="upload-form">
            <div class="upload-status" *ngIf="showUploadMessage" [class.success]="uploadMessage.includes('succes')" [class.error]="!uploadMessage.includes('succes')">
              {{ uploadMessage }}
            </div>
            
            <div class="form-group">
              <label for="image-description-istorie">{{ 'landscapesImageDescription' | translate }}</label>
              <input 
                type="text" 
                id="image-description-istorie" 
                [(ngModel)]="imageDescription" 
                [placeholder]="'landscapesImageDescriptionPlaceholder' | translate"
                class="description-input"
              >
            </div>
            
            <div class="form-group">
              <label for="image-upload-istorie" class="file-upload-label">
                <span class="upload-icon">üì∑</span>
                <span>{{ 'landscapesSelectImages' | translate }}</span>
              </label>
              <input 
                type="file" 
                id="image-upload-istorie" 
                (change)="onFileSelected($event)" 
                accept="image/*" 
                multiple
                class="file-input"
              >
              <div *ngIf="selectedFiles.length > 0" class="selected-files-info">
                <div class="selected-files-header">
                  {{ getSelectedFilesText() }}
                </div>
                <div class="selected-files-list">
                  <div *ngFor="let file of selectedFiles; let i = index" class="selected-file-item">
                    <span class="file-name">{{ file.name }}</span>
                    <button type="button" class="remove-file-btn" (click)="removeFile(i)" [title]="'landscapesRemoveFile' | translate">
                      √ó
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <button 
              (click)="uploadImages()" 
              [disabled]="isUploading || selectedFiles.length === 0" 
              class="upload-btn"
            >
              <span *ngIf="!isUploading">{{ getUploadButtonText() }}</span>
              <span *ngIf="isUploading">{{ getUploadingText() }}</span>
            </button>
          </div>
        </div>

        <div class="images-grid">
          <div class="image-item" *ngFor="let image of getPaginatedImages()" (click)="openGallery(image)">
            <div class="image-container">
              <img [src]="image.url || getImageUrl(image.path!)" [alt]="image.filename" class="gallery-image" loading="lazy" />
              
              <div *ngIf="isAdmin && image.id" class="admin-overlay">
                <button 
                  (click)="deleteImage(image.id); $event.stopPropagation()" 
                  class="admin-delete-btn" 
                  [title]="'landscapesDeleteImage' | translate"
                >
                  <span class="delete-icon">üóëÔ∏è</span>
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="pagination-controls" *ngIf="totalPages > 1">
          <button class="pagination-btn" (click)="prevPage()" [disabled]="currentPage === 1">
            {{ 'exhibitionsPrevious' | translate }}
          </button>
          
          <div class="page-numbers">
            <button 
              *ngFor="let pageNum of getPageNumbers()" 
              class="page-number" 
              [class.active]="pageNum === currentPage"
              (click)="goToPage(pageNum)">
              {{ pageNum }}
            </button>
          </div>
          
          <button class="pagination-btn" (click)="nextPage()" [disabled]="currentPage === totalPages">
            {{ 'exhibitionsNext' | translate }}
          </button>
        </div>
        
        <div class="pagination-info" *ngIf="totalPages > 1">
          <p>{{ getPageInfoText() }}</p>
        </div>
      </div>

      <div class="section-description" *ngIf="selectedSection === 'etnografie'">
        <h2>{{ 'exhibitionsEthnographyTitle' | translate }}</h2>
        <p><em>{{ 'exhibitionsEthnographyInaugurated' | translate }}</em></p>
        <p>
          {{ 'exhibitionsEthnographyDescription' | translate }}
        </p>

        <div *ngIf="isAdmin" class="admin-section">
          <div class="admin-header">
            <h3>{{ 'landscapesAdminSection' | translate }}</h3>
          </div>
          
          <div class="upload-form">
            <div class="upload-status" *ngIf="showUploadMessage" [class.success]="uploadMessage.includes('succes')" [class.error]="!uploadMessage.includes('succes')">
              {{ uploadMessage }}
            </div>
            
            <div class="form-group">
              <label for="image-description-etnografie">{{ 'landscapesImageDescription' | translate }}</label>
              <input 
                type="text" 
                id="image-description-etnografie" 
                [(ngModel)]="imageDescription" 
                [placeholder]="'landscapesImageDescriptionPlaceholder' | translate"
                class="description-input"
              >
            </div>
            
            <div class="form-group">
              <label for="image-upload-etnografie" class="file-upload-label">
                <span class="upload-icon">üì∑</span>
                <span>{{ 'landscapesSelectImages' | translate }}</span>
              </label>
              <input 
                type="file" 
                id="image-upload-etnografie" 
                (change)="onFileSelected($event)" 
                accept="image/*" 
                multiple
                class="file-input"
              >
              <div *ngIf="selectedFiles.length > 0" class="selected-files-info">
                <div class="selected-files-header">
                  {{ getSelectedFilesText() }}
                </div>
                <div class="selected-files-list">
                  <div *ngFor="let file of selectedFiles; let i = index" class="selected-file-item">
                    <span class="file-name">{{ file.name }}</span>
                    <button type="button" class="remove-file-btn" (click)="removeFile(i)" [title]="'landscapesRemoveFile' | translate">
                      √ó
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <button 
              (click)="uploadImages()" 
              [disabled]="isUploading || selectedFiles.length === 0" 
              class="upload-btn"
            >
              <span *ngIf="!isUploading">{{ getUploadButtonText() }}</span>
              <span *ngIf="isUploading">{{ getUploadingText() }}</span>
            </button>
          </div>
        </div>

        <div class="images-grid">
          <div class="image-item" *ngFor="let image of getPaginatedImages()" (click)="openGallery(image)">
            <div class="image-container">
              <img [src]="image.url || getImageUrl(image.path!)" [alt]="image.filename" class="gallery-image" loading="lazy" />
              
              <div *ngIf="isAdmin && image.id" class="admin-overlay">
                <button 
                  (click)="deleteImage(image.id); $event.stopPropagation()" 
                  class="admin-delete-btn" 
                  [title]="'landscapesDeleteImage' | translate"
                >
                  <span class="delete-icon">üóëÔ∏è</span>
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="pagination-controls" *ngIf="totalPages > 1">
          <button class="pagination-btn" (click)="prevPage()" [disabled]="currentPage === 1">
            {{ 'exhibitionsPrevious' | translate }}
          </button>
          
          <div class="page-numbers">
            <button 
              *ngFor="let pageNum of getPageNumbers()" 
              class="page-number" 
              [class.active]="pageNum === currentPage"
              (click)="goToPage(pageNum)">
              {{ pageNum }}
            </button>
          </div>
          
          <button class="pagination-btn" (click)="nextPage()" [disabled]="currentPage === totalPages">
            {{ 'exhibitionsNext' | translate }}
          </button>
        </div>
        
        <div class="pagination-info" *ngIf="totalPages > 1">
          <p>{{ getPageInfoText() }}</p>
        </div>
      </div>

      <div class="section-description" *ngIf="selectedSection === 'aerLiber'">
        <h2>{{ 'exhibitionsOutdoorTitle' | translate }}</h2>
        <p><em>{{ 'exhibitionsOutdoorCompleted' | translate }}</em></p>
        <p>
          {{ 'exhibitionsOutdoorDescription' | translate }}
        </p>

        <div *ngIf="isAdmin" class="admin-section">
          <div class="admin-header">
            <h3>{{ 'landscapesAdminSection' | translate }}</h3>
          </div>
          
          <div class="upload-form">
            <div class="upload-status" *ngIf="showUploadMessage" [class.success]="uploadMessage.includes('succes')" [class.error]="!uploadMessage.includes('succes')">
              {{ uploadMessage }}
            </div>
            
            <div class="form-group">
              <label for="image-description-aer-liber">{{ 'landscapesImageDescription' | translate }}</label>
              <input 
                type="text" 
                id="image-description-aer-liber" 
                [(ngModel)]="imageDescription" 
                [placeholder]="'landscapesImageDescriptionPlaceholder' | translate"
                class="description-input"
              >
            </div>
            
            <div class="form-group">
              <label for="image-upload-aer-liber" class="file-upload-label">
                <span class="upload-icon">üì∑</span>
                <span>{{ 'landscapesSelectImages' | translate }}</span>
              </label>
              <input 
                type="file" 
                id="image-upload-aer-liber" 
                (change)="onFileSelected($event)" 
                accept="image/*" 
                multiple
                class="file-input"
              >
              <div *ngIf="selectedFiles.length > 0" class="selected-files-info">
                <div class="selected-files-header">
                  {{ getSelectedFilesText() }}
                </div>
                <div class="selected-files-list">
                  <div *ngFor="let file of selectedFiles; let i = index" class="selected-file-item">
                    <span class="file-name">{{ file.name }}</span>
                    <button type="button" class="remove-file-btn" (click)="removeFile(i)" [title]="'landscapesRemoveFile' | translate">
                      √ó
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <button 
              (click)="uploadImages()" 
              [disabled]="isUploading || selectedFiles.length === 0" 
              class="upload-btn"
            >
              <span *ngIf="!isUploading">{{ getUploadButtonText() }}</span>
              <span *ngIf="isUploading">{{ getUploadingText() }}</span>
            </button>
          </div>
        </div>

        <div class="images-grid">
          <div class="image-item" *ngFor="let image of getPaginatedImages()" (click)="openGallery(image)">
            <div class="image-container">
              <img [src]="image.url || getImageUrl(image.path!)" [alt]="image.filename" class="gallery-image" loading="lazy" />
              
              <div *ngIf="isAdmin && image.id" class="admin-overlay">
                <button 
                  (click)="deleteImage(image.id); $event.stopPropagation()" 
                  class="admin-delete-btn" 
                  [title]="'landscapesDeleteImage' | translate"
                >
                  <span class="delete-icon">üóëÔ∏è</span>
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <div class="pagination-controls" *ngIf="totalPages > 1">
          <button class="pagination-btn" (click)="prevPage()" [disabled]="currentPage === 1">
            {{ 'exhibitionsPrevious' | translate }}
          </button>
          
          <div class="page-numbers">
            <button 
              *ngFor="let pageNum of getPageNumbers()" 
              class="page-number" 
              [class.active]="pageNum === currentPage"
              (click)="goToPage(pageNum)">
              {{ pageNum }}
            </button>
          </div>
          
          <button class="pagination-btn" (click)="nextPage()" [disabled]="currentPage === totalPages">
            {{ 'exhibitionsNext' | translate }}
          </button>
        </div>
        
        <div class="pagination-info" *ngIf="totalPages > 1">
          <p>{{ getPageInfoText() }}</p>
        </div>
      </div>
      
      <div class="info-section">
        <h3>{{ 'exhibitionsVisitingSchedule' | translate }}</h3>
        <p>{{ 'exhibitionsVisitingDescription' | translate }}</p>
        <ul>
          <li><strong>{{ 'exhibitionsTuesdayFriday' | translate }}</strong> 9:00 - 17:00</li>
          <li><strong>{{ 'exhibitionsSaturdaySunday' | translate }}</strong> 10:00 - 16:00</li>
          <li><strong>{{ 'exhibitionsMonday' | translate }}</strong> {{ 'exhibitionsClosed' | translate }}</li>
        </ul>
        <p>{{ 'exhibitionsGroupBooking' | translate }}</p>
      </div>

      <div class="gallery-modal" *ngIf="showGallery" [class.fullscreen]="isFullscreen">
        <div class="gallery-overlay" (click)="closeGallery()"></div>
        
        <div class="gallery-content" [class.fullscreen-content]="isFullscreen">
          <button class="gallery-close" (click)="closeGallery()">√ó</button>
          
          <div class="gallery-title">
            <h3>{{ getCurrentImageTitle() }}</h3>
          </div>
          
          <div class="gallery-image-container" 
               (mousedown)="startDrag($event)" 
               (mousemove)="onDrag($event)" 
               (mouseup)="stopDrag()" 
               (mouseleave)="stopDrag()">
            <img *ngIf="currentImage" 
                 [src]="currentImage.url" 
                 [alt]="currentImage.filename" 
                 class="gallery-image" 
                 [ngStyle]="getImageStyle()" 
                 draggable="false" />
          </div>
          
          <div class="gallery-controls">
            <div class="controls-left">
              <button class="gallery-nav prev" (click)="prevImage()" title="Imaginea anterioarƒÉ (‚Üê)">‚ùÆ</button>
            </div>
            
            <div class="controls-center">
              <span class="gallery-counter">{{ currentImageIndex + 1 }} / {{ currentImages.length }}</span>
              
              <div class="action-controls">
                <div class="zoom-controls">
                  <button class="control-button" (click)="zoomOut()" title="Mic»ôoreazƒÉ (-)">‚àí</button>
                  <span class="zoom-level">{{ (zoomLevel * 100).toFixed(0) }}%</span>
                  <button class="control-button" (click)="zoomIn()" title="MƒÉre»ôte (+)">+</button>
                  <button class="control-button" (click)="resetZoom()" title="ReseteazƒÉ zoom (0)">‚Ü∫</button>
                </div>
                
                <div class="transform-controls">
                  <button class="control-button" (click)="resetImageTransforms()" title="ReseteazƒÉ transformƒÉrile">
                    üîÑ
                  </button>
                  <button class="control-button fullscreen-btn" (click)="toggleFullscreen()" [title]="getFullscreenTitle()">
                    <span *ngIf="!isFullscreen">‚õ∂</span>
                    <span *ngIf="isFullscreen">‚ßâ</span>
                  </button>
                </div>
              </div>
            </div>
            
            <div class="controls-right">
              <button class="gallery-nav next" (click)="nextImage()" title="Imaginea urmƒÉtoare (‚Üí)">‚ùØ</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-cadran>
</main>