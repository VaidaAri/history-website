<main class="publicatii-main">
  <div class="decorative-borders">
    <div class="decorative-border-left"></div>
    <div class="decorative-border-right"></div>
  </div>
  
  <app-meniu></app-meniu>
  <app-cadran>
    <div class="publicatii-container">
      <div class="header-nav">
        <button class="back-button" routerLink="/istoric">‚Üê {{ 'publicationsBackToHistory' | translate }}</button>
      </div>
      <h2>{{ 'publicationsTitle' | translate }}</h2>
      
      <div class="category-selector">
        <button [class.active]="selectedCategory === 'arhivaSomesana'" (click)="switchCategory('arhivaSomesana')">{{ 'publicationsArhivaSomesana' | translate }}</button>
        <button [class.active]="selectedCategory === 'scanCoperti'" (click)="switchCategory('scanCoperti')">{{ 'publicationsReviste' | translate }}</button>
      </div>
  
      <!-- Admin Section -->
      <div *ngIf="isAdmin" class="admin-section">
        <div class="admin-header">
          <h3>{{ 'landscapesAdminSection' | translate }}</h3>
        </div>
        
        <div class="upload-form">
          <div class="upload-status" *ngIf="showUploadMessage" [class.success]="uploadMessage.includes('succes')" [class.error]="!uploadMessage.includes('succes')">
            {{ uploadMessage }}
          </div>
          
          <div class="form-group">
            <label for="image-description-publicatie">{{ 'landscapesImageDescription' | translate }}</label>
            <input 
              type="text" 
              id="image-description-publicatie" 
              [(ngModel)]="imageDescription" 
              [placeholder]="'landscapesImageDescriptionPlaceholder' | translate"
              class="description-input"
            >
          </div>
          
          <div class="form-group">
            <label for="image-upload-publicatie" class="file-upload-label">
              <span class="upload-icon">üì∑</span>
              <span>{{ 'landscapesSelectImages' | translate }}</span>
            </label>
            <input 
              type="file" 
              id="image-upload-publicatie" 
              (change)="onFileSelected($event)" 
              accept="image/*" 
              multiple
              class="file-input"
            >
            <div *ngIf="selectedFiles.length > 0" class="selected-files-info">
              <div class="selected-files-header">
                {{ getSelectedFilesText() }}
              </div>
              <div class="selected-files-list">
                <div *ngFor="let file of selectedFiles; let i = index" class="selected-file-item">
                  <span class="file-name">{{ file.name }}</span>
                  <button type="button" class="remove-file-btn" (click)="removeFile(i)" [title]="'landscapesRemoveFile' | translate">
                    √ó
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <button 
            (click)="uploadImages()" 
            [disabled]="isUploading || selectedFiles.length === 0" 
            class="upload-btn"
          >
            <span *ngIf="!isUploading">{{ getUploadButtonText() }}</span>
            <span *ngIf="isUploading">{{ getUploadingText() }}</span>
          </button>
        </div>
      </div>
  
      <div class="publications-grid" *ngIf="selectedCategory === 'arhivaSomesana'">
        <div class="publication-item" *ngFor="let image of arhivaSomesanaImages" (click)="openGallery(image)">
          <div class="publication-image-container">
            <img [src]="image.url || getImageUrl(image.path!)" [alt]="image.filename" class="publication-image" loading="lazy" />
            
            <div *ngIf="isAdmin && image.id" class="admin-overlay">
              <button 
                (click)="deleteImage(image.id); $event.stopPropagation()" 
                class="admin-delete-btn" 
                [title]="'landscapesDeleteImage' | translate"
              >
                <span class="delete-icon">üóëÔ∏è</span>
              </button>
            </div>
          </div>
          <div class="publication-info">
            <p>{{ image.index >= 0 ? (('publicationsPage' | translate) + ' ' + (image.index + 1)) : ('publicationsCover' | translate) }}</p>
          </div>
        </div>
      </div>
      
      <div class="publications-grid" *ngIf="selectedCategory === 'scanCoperti'">
        <div class="publication-item" *ngFor="let image of scanCopertiImages" (click)="openGallery(image)">
          <div class="publication-image-container">
            <img [src]="image.url || getImageUrl(image.path!)" [alt]="image.filename" class="publication-image" loading="lazy" />
            
            <div *ngIf="isAdmin && image.id" class="admin-overlay">
              <button 
                (click)="deleteImage(image.id); $event.stopPropagation()" 
                class="admin-delete-btn" 
                [title]="'landscapesDeleteImage' | translate"
              >
                <span class="delete-icon">üóëÔ∏è</span>
              </button>
            </div>
          </div>
          <div class="publication-info">
            <p>{{ ('publicationsMagazine' | translate) + ' ' + (image.index + 1) }}</p>
          </div>
        </div>
      </div>
  
  <div class="gallery-modal" *ngIf="showGallery">
    <div class="gallery-overlay" (click)="closeGallery()"></div>
    
    <div class="gallery-content">
      <button class="gallery-close" (click)="closeGallery()">√ó</button>
      
      <div class="gallery-title">
        <h3>{{ getCurrentImageTitle() }}</h3>
      </div>
      
      <div class="gallery-image-container" 
           (mousedown)="startDrag($event)" 
           (mousemove)="onDrag($event)" 
           (mouseup)="stopDrag()" 
           (mouseleave)="stopDrag()">
        <img *ngIf="currentImage" 
             [src]="currentImage.url" 
             [alt]="currentImage.filename" 
             class="gallery-image" 
             [ngStyle]="getImageStyle()" 
             draggable="false" />
      </div>
      
      <div class="gallery-controls">
        <div class="controls-left">
          <button class="gallery-nav prev" (click)="prevImage()">‚ùÆ</button>
        </div>
        
        <div class="controls-center">
          <span class="gallery-counter">{{ currentImageIndex + 1 }} / {{ currentImages.length }}</span>
          
          <div class="zoom-controls">
            <button class="zoom-button" (click)="zoomOut()" [title]="'publicationsZoomOut' | translate">‚àí</button>
            <span class="zoom-level">{{ (zoomLevel * 100).toFixed(0) }}%</span>
            <button class="zoom-button" (click)="zoomIn()" [title]="'publicationsZoomIn' | translate">+</button>
            <button class="zoom-button" (click)="resetZoom()" [title]="'publicationsResetZoom' | translate">‚Ü∫</button>
            <button class="zoom-button" (click)="toggleFullscreen()" [title]="'publicationsFullscreen' | translate">‚õ∂</button>
          </div>
        </div>
        
        <div class="controls-right">
          <button class="gallery-nav next" (click)="nextImage()">‚ùØ</button>
        </div>
      </div>
    </div>
  </div>
    </div>
  </app-cadran>
</main>
