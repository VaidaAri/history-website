<main class="prietenii-muzeului">
  <!-- Borduri decorative cu modele populare românești -->
  <div class="decorative-borders">
    <div class="decorative-border-left"></div>
    <div class="decorative-border-right"></div>
  </div>
  
  <app-meniu></app-meniu>
  <app-cadran>
    <div class="container">
      <div class="header-nav">
        <button class="back-button" routerLink="/">← Înapoi la pagina principală</button>
        <h1 class="title">Prietenii Muzeului</h1>
      </div>
      
      <p class="intro-text">
        Muzeul Grăniceresc Năsăudean este un loc plin de viață, unde istoria prinde culoare prin zâmbetele copiilor din școlile care ne vizitează cu entuziasm! 
        Prietenii noștri sunt clasele pline de elevi curioși care descoperă cu ochii mari exponatele, voluntarii care ne ajută la târgurile de Crăciun și evenimentele speciale, 
        familiile care petrec weekenduri frumoase explorând trecutul, și toți cei care își deschid inimile pentru patrimoniul cultural al Năsăudului. 
        Fiecare vizitator, fiecare mână de ajutor, fiecare poveste împărtășită face din muzeul nostru un spațiu al comunității!
      </p>

      <!-- Secțiunea de administrare (vizibilă doar pentru administratori) -->
      <div *ngIf="isAdmin" class="admin-section">
        <div class="admin-header">
          <h3>Administrare imagini</h3>
        </div>
        
        <div class="upload-form">
          <div class="upload-status" *ngIf="showUploadMessage" [class.success]="uploadMessage.includes('succes')" [class.error]="!uploadMessage.includes('succes')">
            {{ uploadMessage }}
          </div>
          
          <div class="form-group">
            <label for="image-description">Descriere imagine:</label>
            <input 
              type="text" 
              id="image-description" 
              [(ngModel)]="imageDescription" 
              placeholder="Adaugă o descriere pentru imagine..."
              class="description-input"
            >
          </div>
          
          <div class="form-group">
            <label for="image-upload" class="file-upload-label">
              <span class="upload-icon">📷</span>
              <span>Selectează imagini</span>
            </label>
            <input 
              type="file" 
              id="image-upload" 
              (change)="onFileSelected($event)" 
              accept="image/*" 
              multiple
              class="file-input"
            >
            <div *ngIf="selectedFiles.length > 0" class="selected-files-info">
              <div class="selected-files-header">
                Fișiere selectate ({{ selectedFiles.length }}):
              </div>
              <div class="selected-files-list">
                <div *ngFor="let file of selectedFiles; let i = index" class="selected-file-item">
                  <span class="file-name">{{ file.name }}</span>
                  <button type="button" class="remove-file-btn" (click)="removeFile(i)" title="Elimină fișierul">
                    ×
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <button 
            (click)="uploadImages()" 
            [disabled]="isUploading || selectedFiles.length === 0" 
            class="upload-btn"
          >
            <span *ngIf="!isUploading">Încarcă imaginile ({{ selectedFiles.length }})</span>
            <span *ngIf="isUploading">Se încarcă {{ currentUploadIndex + 1 }}/{{ selectedFiles.length }}...</span>
          </button>
        </div>
      </div>

      <!-- Mesaj când nu există imagini -->
      <div *ngIf="prieteniImages.length === 0" class="no-images">
        <p>Nu există imagini disponibile momentan.</p>
      </div>

      <!-- Grid de imagini similar cu expozitii-permanente -->
      <div *ngIf="prieteniImages.length > 0" class="prieteni-gallery">
        <div class="images-grid">
          <div class="image-item" *ngFor="let image of getPaginatedImages()" (click)="openGallery(image)">
            <div class="image-container">
              <img [src]="getImageUrl(image.path)" [alt]="image.description" class="gallery-image" loading="lazy" />
              
              <!-- Overlay cu informații administrative pentru admin -->
              <div *ngIf="isAdmin" class="admin-overlay">
                <button 
                  (click)="deleteImage(image.id); $event.stopPropagation()" 
                  class="admin-delete-btn" 
                  title="Șterge imaginea"
                >
                  <span class="delete-icon">🗑️</span>
                </button>
              </div>
            </div>
            <!-- <div class="image-info">
              <p>{{ image.description }}</p>
            </div> -->
          </div>
        </div>
        
        <!-- Controale de paginare -->
        <div class="pagination-controls" *ngIf="totalPages > 1">
          <button class="pagination-btn" (click)="prevPage()" [disabled]="currentPage === 1">
            ❮ Anterior
          </button>
          
          <div class="page-numbers">
            <button 
              *ngFor="let pageNum of getPageNumbers()" 
              class="page-number" 
              [class.active]="pageNum === currentPage"
              (click)="goToPage(pageNum)">
              {{ pageNum }}
            </button>
          </div>
          
          <button class="pagination-btn" (click)="nextPage()" [disabled]="currentPage === totalPages">
            Următorul ❯
          </button>
        </div>
        
        <div class="pagination-info" *ngIf="totalPages > 1">
          <p>Pagina {{ currentPage }} din {{ totalPages }}</p>
        </div>
      </div>

      
      <div class="contact-section">
        <h3>Contact pentru informații</h3>
        <p>Pentru mai multe informații despre programul "Prietenii Muzeului" sau despre cum puteți contribui, vă rugăm să ne contactați:</p>
        <div class="contact-details">
          <p><strong>Email:</strong> prieteni&#64;muzeunasaud.ro</p>
          <p><strong>Telefon:</strong> 0263 361853</p>
        </div>
      </div>
      
    </div>

    <!-- Galeria modal -->
    <div class="gallery-modal" *ngIf="showGallery" [class.fullscreen]="isFullscreen">
      <div class="gallery-overlay" (click)="closeGallery()"></div>
      
      <div class="gallery-content" [class.fullscreen-content]="isFullscreen">
        <button class="gallery-close" (click)="closeGallery()">×</button>
        
        <div class="gallery-title">
          <h3>Prietenii Muzeului</h3>
        </div>
        
        <div class="gallery-image-container" 
             (mousedown)="startDrag($event)" 
             (mousemove)="onDrag($event)" 
             (mouseup)="stopDrag()" 
             (mouseleave)="stopDrag()">
          <img *ngIf="currentImage" 
               [src]="getImageUrl(currentImage.path)" 
               [alt]="currentImage.description" 
               class="gallery-image" 
               [ngStyle]="getImageStyle()" 
               draggable="false" />
        </div>
        
        <div class="gallery-controls">
          <div class="controls-left">
            <button class="gallery-nav prev" (click)="prevModalImage()" title="Imaginea anterioară (←)">❮</button>
          </div>
          
          <div class="controls-center">
            <span class="gallery-counter">{{ currentModalImageIndex + 1 }} / {{ prieteniImages.length }}</span>
            
            <div class="action-controls">
              <div class="zoom-controls">
                <button class="control-button" (click)="zoomOut()" title="Micșorează (-)">−</button>
                <span class="zoom-level">{{ (zoomLevel * 100).toFixed(0) }}%</span>
                <button class="control-button" (click)="zoomIn()" title="Mărește (+)">+</button>
                <button class="control-button" (click)="resetZoom()" title="Resetează zoom (0)">↺</button>
              </div>
              
              <div class="transform-controls">
                <button class="control-button" (click)="resetImageTransforms()" title="Resetează transformările">
                  🔄
                </button>
                <button class="control-button fullscreen-btn" (click)="toggleFullscreen()" [title]="isFullscreen ? 'Ieși din fullscreen (F)' : 'Fullscreen (F)'">
                  <span *ngIf="!isFullscreen">⛶</span>
                  <span *ngIf="isFullscreen">⧉</span>
                </button>
              </div>
            </div>
            
            <!-- Informații administrative pentru admin -->
            <div *ngIf="isAdmin && currentImage" class="admin-modal-info">
              <div class="admin-detail">ID: {{ currentImage.id }}</div>
              <div class="admin-detail">{{ currentImage.description }}</div>
            </div>
          </div>
          
          <div class="controls-right">
            <button class="gallery-nav next" (click)="nextModalImage()" title="Imaginea următoare (→)">❯</button>
          </div>
        </div>
      </div>
    </div>
  </app-cadran>
</main>